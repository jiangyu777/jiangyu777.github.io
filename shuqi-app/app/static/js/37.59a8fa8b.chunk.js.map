{"version":3,"sources":["scripts/views/login/index.js","utils/history.js","scripts/components/Head/index.js","assets/images/home.png","utils/axios.js","utils/index.js"],"names":["mobileReg","codeReg","timer","num","tabs","title","Login","setMobile","val","code","state","value","setState","phoneFlag","test","loginFlag","setCode","mobile","receiveCode","setInterval","txt","toggle","clearInterval","axios","post","then","res","gotoLogin","data","type","history","push","sessionStorage","token","this","className","show","initialPage","tabBarActiveTextColor","tabBarUnderlineStyle","border","style","display","alignItems","justifyContent","height","backgroundColor","placeholder","lineHeight","color","float","ref","el","onChange","onClick","disabled","inline","size","Component","createHashHistory","Head","goback","go","gotoSearch","props","mode","icon","onLeftClick","rightContent","src","require","width1","module","exports","defaults","baseURL","headers","common","alert","failToast","msg","hide","fail","interceptors","request","use","config","loading","console","log","error","Promise","reject","response","info","alertInstance","text","onPress","setTimeout","close","showAlert"],"mappings":"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","file":"static/js/37.59a8fa8b.chunk.js","sourcesContent":["\r\nimport \"./index.scss\";\r\n\r\nimport Head from \"~/components/Head\"\r\nimport { Tabs, WhiteSpace, Badge, WingBlank, InputItem, List, Button } from \"antd-mobile\";\r\nexport const mobileReg = /^1(3|5|7|8|9)\\d{9}$/\r\nexport const codeReg = /^\\d{4}$/;\r\nlet timer = null;\r\nexport const num = 60;\r\n\r\nimport { axios } from \"&\"\r\nimport {history} from \"&/history\"\r\n\r\n\r\n\r\n\r\nconst tabs = [\r\n{ title: <Badge >账户密码</Badge> },\r\n{ title: <Badge >手机验证码</Badge> },\r\n\r\n];\r\n\r\nexport default class Login extends Component {\r\n\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            phoneFlag:false,\r\n            loginFlag:false,\r\n            txt:\"获取验证码\",\r\n            num,\r\n            toggle:true\r\n        }\r\n    }\r\n\r\n\r\n    setMobile=(val)=>{\r\n       \r\n        const code = this.code.state.value;\r\n        this.setState({\r\n            phoneFlag:mobileReg.test(val),\r\n            loginFlag:mobileReg.test(val)&&codeReg.test(code)\r\n        })\r\n    }\r\n    setCode=(val)=>{\r\n      \r\n      \r\n        this.setState({\r\n            loginFlag:mobileReg.test(this.mobile.state.value)&&codeReg.test(val)\r\n        })\r\n    }\r\n\r\n    receiveCode=()=>{\r\n        timer = setInterval(()=>{\r\n            if(this.state.num>0){\r\n                this.state.num--;\r\n                this.setState({\r\n                    num:this.state.num,\r\n                    txt:\"还剩 \" + this.state.num + \" S\",\r\n                    phoneFlag:false,\r\n                    toggle:false\r\n                })\r\n            }else{\r\n                this.setState({\r\n                    num,\r\n                    txt:\"获取验证码\",\r\n                    phoneFlag:true,\r\n                    toggle:true\r\n                })\r\n                clearInterval(timer);\r\n            }\r\n        },1000);\r\n\r\n        axios.post(\"/react/sendCode\",{\r\n            mobile:this.mobile.state.value,\r\n        }).then(res=>{\r\n          \r\n        })\r\n\r\n    }\r\n\r\n\r\n    gotoLogin=()=>{\r\n        axios.post(\"/react/checkCode\",{\r\n            mobile:this.mobile.state.value,\r\n            code:this.code.state.value\r\n        }).then(res=>{\r\n            if(!!res.data.type){\r\n                history.push(\"./mine\")\r\n                sessionStorage.token = res.data.token\r\n\r\n            }else{\r\n                sessionStorage.token = \"\";\r\n            }\r\n        })\r\n\r\n    }\r\n\r\nrender() {\r\n    const {\r\n        phoneFlag,\r\n        loginFlag,\r\n        txt,\r\n        toggle\r\n    }  = this.state;\r\n\r\nreturn (\r\n    <div className=\"indexview\">\r\n        <Head title=\"登陆\" show={true} ></Head>\r\n        <div>\r\n            <WhiteSpace />\r\n            <div >\r\n                <Tabs tabs={tabs}\r\n                    initialPage={'t2'}\r\n                    tabBarActiveTextColor=\"#00c98d\"\r\n                    tabBarUnderlineStyle={{border:\"2px solid #00c98d\"}}\r\n                >\r\n                    <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%', backgroundColor: '#fff' }}>\r\n\r\n                        <WingBlank>\r\n                          <WhiteSpace/>\r\n                            <List>\r\n                                <WhiteSpace />\r\n                                <InputItem\r\n                                    type=\"tel\"\r\n                                    placeholder=\"请输入手机号码\"\r\n                                >\r\n                                    账户\r\n                                </InputItem>\r\n                                <WhiteSpace />\r\n\r\n                                <InputItem\r\n                                    type=\"number\"\r\n                                    placeholder=\"请输入密码\"\r\n                                   \r\n\r\n                                >\r\n                                    密码\r\n                                </InputItem>\r\n\r\n\r\n                            </List>\r\n\r\n\r\n\r\n                            <Button type=\"primary\" style={{ backgroundColor: \"#00c98d\" }} >登陆</Button>\r\n\r\n                            <p style={{ height: \"1rem\", lineHeight: \"1rem\" }}>\r\n\r\n                                <a style={{ color: \"#999\" }}  >忘记密码</a>\r\n                                <a style={{ color: \"#00c98d\", float: \"right\" }} >注册</a>\r\n\r\n                            </p>\r\n                        </WingBlank>\r\n\r\n\r\n                    </div>\r\n\r\n                    <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%', backgroundColor: '#fff' }}>\r\n\r\n                        <WingBlank>\r\n                           <WhiteSpace/>\r\n                            <List>\r\n                                <WhiteSpace />\r\n                                <InputItem\r\n                                    type=\"tel\"\r\n                                    placeholder=\"请输入手机号码\"\r\n                                 \r\n                                    ref={el=>this.mobile=el}\r\n                                    onChange={this.setMobile}\r\n\r\n                                >\r\n                                    手机号码\r\n                                </InputItem>\r\n\r\n                                <WhiteSpace />\r\n\r\n                                <InputItem\r\n                                    type=\"number\"\r\n                                    placeholder=\"请输入验证码\"\r\n                                   \r\n                                    ref={el=>this.code=el}\r\n                                    onChange={this.setCode}\r\n                                >\r\n                                    验证码\r\n                                </InputItem>\r\n\r\n                                <Button onClick={this.receiveCode} disabled={ !phoneFlag } style={{ backgroundColor: \"#00c98d\" }} className=\"l-btn\" inline size=\"large\" type=\"primary\" >{txt}</Button>\r\n                            </List>\r\n\r\n                            <Button onClick={this.gotoLogin} disabled={ !loginFlag } type=\"primary\" style={{ backgroundColor: \"#00c98d\" }} >登陆</Button>\r\n                            <p style={{ height: \"1rem\", lineHeight: \"1rem\" }}>\r\n\r\n                                <a style={{ color: \"#999\" }}  >忘记密码</a>\r\n                                <a style={{ color: \"#00c98d\", float: \"right\" }} >注册</a>\r\n\r\n                            </p>\r\n                        </WingBlank>\r\n\r\n\r\n\r\n                    </div>\r\n\r\n                </Tabs>\r\n            </div>\r\n        </div>\r\n\r\n\r\n    </div>\r\n)\r\n}\r\n}","\r\nimport {createHashHistory,createBrowserHistory} from \"history\";\r\n\r\nexport const history = new createHashHistory();\r\n\r\n// export {history};","\r\nimport \"./index.scss\"\r\n\r\nimport {NavBar,Icon} from \"antd-mobile\"\r\n\r\n\r\nimport {history} from \"&/history\";\r\n\r\nexport default class Head extends Component{\r\n\r\n    goback=(show)=>{\r\n        if(show){\r\n            \r\n            history.go(-1);\r\n        }\r\n    }\r\n\r\n    gotoSearch=()=>{\r\n        history.push(\"/home\");\r\n    }\r\n\r\n    render(){\r\n        const {\r\n            show,\r\n        \r\n        }  = this.props;\r\n        return(\r\n            <NavBar\r\n                className=\"head\"\r\n                mode=\"dark\"\r\n                icon={show&&<Icon style={{color:\"#00c98d\"}} type=\"left\" />}\r\n                onLeftClick={ ()=>this.goback(show) }\r\n                rightContent={[\r\n                    <img src={require(\"@/assets/images/home.png\")}  onClick={this.gotoSearch}  style={{ width1:\"0.4rem\" , height:\"0.4rem\" }} />,\r\n                  \r\n                ]}\r\n            >{this.props.title}</NavBar>\r\n        )\r\n    }\r\n}\r\n","module.exports = __webpack_public_path__ + \"static/media/home.48a04f55.png\";","\r\n\r\n\r\nimport axios from \"axios\";\r\n\r\n// axios.defaults.baseURL = \"http://localhost:1906/\";  //开发环境\r\naxios.defaults.baseURL = \"https://jiangyu777.com:1906/\";    // 线上环境\r\n  \r\nlet token = \"\";\r\naxios.defaults.headers.common['token'] = token;    // token \r\naxios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\r\nimport {Toast,Modal } from \"antd-mobile\"\r\nimport {history} from \"&/history\"\r\n\r\nconst alert = Modal.alert;\r\nconst showAlert = () => {\r\n    const alertInstance = alert('登录提示', '你确定是否前往登陆', [\r\n      { text: '我就看看', onPress: () => console.log('游客访问'), style: 'default' },\r\n      { text: '马上登录', onPress: () => history.push(\"/login\") },\r\n    ]);\r\n    setTimeout(() => {\r\n      // 可以调用close方法以在外部close\r\n      console.log('auto close');\r\n      alertInstance.close();\r\n    }, 500000);\r\n};\r\n\r\nexport function loadingToast(msg) {\r\n    Toast.hide();\r\n    Toast.loading(msg, 1, () => {\r\n      console.log('Load complete !!!');\r\n    });\r\n}\r\n\r\nexport function failToast(msg) {\r\n    Toast.hide();\r\n    Toast.fail(msg, 1);\r\n}\r\n\r\nexport function showToast(msg) {\r\n    Toast.hide();\r\n    Toast.info(msg, 1);\r\n}\r\n\r\n\r\n// 拦截器配置    Interceptors \r\n// 发送请求之前 添加拦截器  \r\naxios.interceptors.request.use(function (config) {\r\n    // 发送之前做的事情 \r\n    loadingToast(\"请求中\");\r\n    config.headers['token'] =  sessionStorage.token;\r\n    console.log(config);\r\n\r\n    return config;\r\n}, function (error) {\r\n    // 发送失败 做的失败 \r\n    failToast(\"请求失败\")\r\n    return Promise.reject(error);\r\n});\r\n\r\n// 响应数据 的拦截器 \r\naxios.interceptors.response.use(function (response) {\r\n    // 成功接收到数据 \r\n    console.log(response);\r\n    // setTimeout(()=>{\r\n        showToast(response.data.msg);\r\n        if(response.data.code==500){\r\n            showAlert();\r\n        }\r\n    // },10)\r\n    return response;\r\n}, function (error) {\r\n    failToast(\"响应失败\");\r\n    // 无法接收到数据  \r\n    return Promise.reject(error);\r\n});\r\n\r\n\r\nexport  {axios};\r\n","\r\n\r\n\r\n//commonJS 规范 \r\n//export default\r\n//\r\n\r\n\r\n\r\nimport url from \"url\";\r\n\r\nexport function getQuery(search){\r\n    return url.parse(search,true).query;\r\n}\r\n\r\nexport {axios} from \"./axios\";"],"sourceRoot":""}